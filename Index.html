<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„ÙŠØ±Ø© - Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ù„Ø­Ø¸ÙŠ</title>
    <!-- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Cairo', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #f1f5f9; color: #0f172a; margin: 0; padding: 0; }
        .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05); }
        .currency-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        input::placeholder { color: #cbd5e1; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const RATE = 100;
        const DENOMS_NEW = [
            { v: 500, s: 'ğŸŒ¾', n: 'Ø³Ù†Ø§Ø¨Ù„' }, { v: 200, s: 'ğŸ«’', n: 'Ø²ÙŠØªÙˆÙ†' }, 
            { v: 100, s: 'â˜ï¸', n: 'Ù‚Ø·Ù†' }, { v: 50, s: 'ğŸŠ', n: 'Ø­Ù…Ø¶ÙŠØ§Øª' }, 
            { v: 25, s: 'ğŸ‡', n: 'Ø¹Ù†Ø¨' }, { v: 10, s: 'ğŸŒ¼', n: 'ÙŠØ§Ø³Ù…ÙŠÙ†' }
        ];

        const CURRENCIES = [
            { code: 'USD', flag: 'ğŸ‡ºğŸ‡¸', name: 'Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ' },
            { code: 'AED', flag: 'ğŸ‡¦ğŸ‡ª', name: 'Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ' },
            { code: 'SAR', flag: 'ğŸ‡¸ğŸ‡¦', name: 'Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ' },
            { code: 'EUR', flag: 'ğŸ‡ªğŸ‡º', name: 'ÙŠÙˆØ±Ùˆ Ø£ÙˆØ±ÙˆØ¨ÙŠ' },
            { code: 'JOD', flag: 'ğŸ‡¯ğŸ‡´', name: 'Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ' },
            { code: 'TRY', flag: 'ğŸ‡¹ğŸ‡·', name: 'Ù„ÙŠØ±Ø© ØªØ±ÙƒÙŠØ©' }
        ];

        // Ø£Ø³Ø¹Ø§Ø± ØµØ±Ù ÙˆØ³Ø·ÙŠÙ‘Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        const defaultRates = {
            USD: { mid: 111.00 }, AED: { mid: 30.22 }, SAR: { mid: 29.60 },
            EUR: { mid: 130.33 }, JOD: { mid: 156.63 }, TRY: { mid: 3.50 }
        };

        function App() {
            const [val, setVal] = useState('');
            const [mode, setMode] = useState('oldToNew'); // 'oldToNew' or 'newToOld'
            const [rates, setRates] = useState(defaultRates);

            useEffect(() => {
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
                fetch("https://raw.githubusercontent.com/laithi/lira-telegram-bot/main/rates.json")
                    .then(res => res.json())
                    .then(data => { if(data.rates) setRates(data.rates); })
                    .catch(() => console.log("ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©"));
            }, []);

            const cleanInput = (text) => {
                const normalized = text.replace(/[Ù -Ù©]/g, d => "0123456789"["Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(d)] || d);
                return normalized.replace(/[^0-9.]/g, '');
            };

            const num = parseFloat(cleanInput(val)) || 0;
            const convertedVal = mode === 'oldToNew' ? num / RATE : num * RATE;
            const liraNewBase = mode === 'oldToNew' ? convertedVal : num;

            const breakdown = useMemo(() => {
                let current = liraNewBase;
                const list = [];
                if (current > 0) {
                    DENOMS_NEW.forEach(d => {
                        const count = Math.floor(current / d.v);
                        if (count > 0) {
                            list.push({ ...d, count });
                            current = Math.round((current - count * d.v) * 100) / 100;
                        }
                    });
                }
                return { list, rem: current };
            }, [liraNewBase]);

            return (
                <div className="max-w-md mx-auto p-4 space-y-5 select-none">
                    {/* Header */}
                    <div className="flex justify-between items-center px-1">
                        <div>
                            <h1 className="text-2xl font-black text-indigo-600 leading-none">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„ÙŠØ±Ø©</h1>
                            <p className="text-[9px] font-bold text-slate-400 uppercase tracking-widest mt-1">Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ù„Ø­Ø¸ÙŠ</p>
                        </div>
                        <div className="bg-slate-200 p-1 rounded-xl flex">
                            <button 
                                onClick={() => setMode('oldToNew')}
                                className={`px-4 py-1.5 rounded-lg text-[10px] font-black transition-all ${mode === 'oldToNew' ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-500'}`}
                            >Ù‚Ø¯ÙŠÙ…</button>
                            <button 
                                onClick={() => setMode('newToOld')}
                                className={`px-4 py-1.5 rounded-lg text-[10px] font-black transition-all ${mode === 'newToOld' ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-500'}`}
                            >Ø¬Ø¯ÙŠØ¯</button>
                        </div>
                    </div>

                    {/* Input Area */}
                    <div className="bg-white rounded-[32px] p-7 card-shadow border border-slate-100">
                        <div className="text-[10px] font-black text-slate-400 uppercase mb-2 tracking-tighter">
                            Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ({mode === 'oldToNew' ? 'Ù„.Ø³ Ù‚Ø¯ÙŠÙ…Ø©' : 'Ù„ÙŠØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©'})
                        </div>
                        <input 
                            type="text" 
                            inputMode="decimal"
                            value={val}
                            onChange={(e) => setVal(e.target.value)}
                            placeholder="0.00"
                            className="w-full text-5xl font-black bg-transparent outline-none caret-indigo-600 text-slate-800"
                        />
                        <div className="mt-6 pt-5 border-t border-slate-50 flex justify-between items-center">
                            <div>
                                <div className="text-[9px] font-black text-slate-300 uppercase">Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„ ({mode === 'oldToNew' ? 'Ù„ÙŠØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©' : 'Ù„.Ø³ Ù‚Ø¯ÙŠÙ…Ø©'})</div>
                                <div className="text-3xl font-black text-indigo-600">
                                    {convertedVal.toLocaleString('ar-EG', { maximumFractionDigits: 2 })}
                                </div>
                            </div>
                            <div className="text-right">
                                <span className="inline-block px-2 py-1 rounded-md bg-green-50 text-green-600 text-[9px] font-bold uppercase tracking-widest">Ù…Ø¨Ø§Ø´Ø±</span>
                            </div>
                        </div>
                    </div>

                    {/* Currency Grid */}
                    <div className="space-y-3">
                        <h2 className="text-[10px] font-black text-slate-400 px-2 uppercase tracking-widest">ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ©</h2>
                        <div className="currency-grid">
                            {CURRENCIES.map(c => {
                                const rate = rates[c.code]?.mid;
                                const result = (rate && liraNewBase > 0) ? (liraNewBase / rate).toFixed(2) : "0.00";
                                return (
                                    <div key={c.code} className="bg-white p-4 rounded-2xl border border-slate-100 flex flex-col justify-between h-28 card-shadow">
                                        <div className="flex justify-between items-start">
                                            <span className="text-xl">{c.flag}</span>
                                            <span className="text-[9px] font-black text-slate-300">{c.code}</span>
                                        </div>
                                        <div>
                                            <div className="text-xl font-black text-indigo-600">{result}</div>
                                            <div className="text-[8px] font-bold text-slate-400 uppercase truncate">{c.name}</div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {/* Banknotes */}
                    {breakdown.list.length > 0 && (
                        <div className="space-y-3 pb-8">
                            <h2 className="text-[10px] font-black text-slate-400 px-2 uppercase tracking-widest">Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…Ù‚Ø§Ø¨Ù„Ø©</h2>
                            <div className="grid grid-cols-1 gap-2">
                                {breakdown.list.map(p => (
                                    <div key={p.v} className="bg-white p-3 rounded-2xl border border-slate-100 flex items-center justify-between card-shadow">
                                        <div className="flex items-center gap-3">
                                            <div className="w-10 h-10 rounded-xl bg-slate-50 flex items-center justify-center text-xl">{p.s}</div>
                                            <div>
                                                <div className="font-black text-lg leading-none">{p.v}</div>
                                                <div className="text-[9px] font-bold text-slate-400">{p.n}</div>
                                            </div>
                                        </div>
                                        <div className="bg-indigo-600 text-white min-w-[40px] h-10 rounded-xl flex items-center justify-center font-black text-lg px-2 shadow-sm">
                                            Ã—{p.count}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
