<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„ÙŠØ±Ø© â€“ Ù…Ø­ÙˆÙ‘Ù„ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <!-- React + ReactDOM + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Cairo font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" />

  <style>
    * {
      font-family: "Cairo", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    body {
      margin: 0;
      background-color: #e6f4f1;
      color: #0f172a;
    }
    .card-shadow {
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
    }
    .currency-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    input::placeholder {
      color: #cbd5e1;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨ÙˆØª
    const RATE = 100;

    const DENOMS_NEW = [
      { v: 500, s: "ğŸŒ¾", n: "Ø³Ù†Ø§Ø¨Ù„ Ø§Ù„Ù‚Ù…Ø­" },
      { v: 200, s: "ğŸ«’", n: "Ø£ØºØµØ§Ù† Ø§Ù„Ø²ÙŠØªÙˆÙ†" },
      { v: 100, s: "â˜ï¸", n: "Ø§Ù„Ù‚Ø·Ù† Ø§Ù„Ø³ÙˆØ±ÙŠ" },
      { v: 50,  s: "ğŸŠ", n: "Ø§Ù„Ø­Ù…Ø¶ÙŠØ§Øª" },
      { v: 25,  s: "ğŸ‡", n: "Ø§Ù„Ø¹Ù†Ø¨" },
      { v: 10,  s: "ğŸŒ¼", n: "ÙŠØ§Ø³Ù…ÙŠÙ† Ø§Ù„Ø´Ø§Ù…" }
    ];

    // Ù†ÙØ³ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ø¨ÙˆØª (Ù…Ø¹ Ø§Ù„Ø£Ø¹Ù„Ø§Ù… ÙˆØ§Ù„Ø£Ø³Ù…Ø§Ø¡)
    const CURRENCIES = [
      { code: "USD", flag: "ğŸ‡ºğŸ‡¸", name: "Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ" },
      { code: "AED", flag: "ğŸ‡¦ğŸ‡ª", name: "Ø§Ù„Ø¯Ø±Ù‡Ù… Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠ" },
      { code: "SAR", flag: "ğŸ‡¸ğŸ‡¦", name: "Ø§Ù„Ø±ÙŠØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ" },
      { code: "EUR", flag: "ğŸ‡ªğŸ‡º", name: "Ø§Ù„ÙŠÙˆØ±Ùˆ Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠ" },
      { code: "KWD", flag: "ğŸ‡°ğŸ‡¼", name: "Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„ÙƒÙˆÙŠØªÙŠ" },
      { code: "SEK", flag: "ğŸ‡¸ğŸ‡ª", name: "Ø§Ù„ÙƒØ±ÙˆÙ†Ø© Ø§Ù„Ø³ÙˆÙŠØ¯ÙŠØ©" },
      { code: "GBP", flag: "ğŸ‡¬ğŸ‡§", name: "Ø§Ù„Ø¬Ù†ÙŠÙ‡ Ø§Ù„Ø¥Ø³ØªØ±Ù„ÙŠÙ†ÙŠ" },
      { code: "JOD", flag: "ğŸ‡¯ğŸ‡´", name: "Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„Ø£Ø±Ø¯Ù†ÙŠ" }
    ];

    // Ø£Ø³Ø¹Ø§Ø± Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ùˆ Ù…Ø§ Ø§Ø´ØªØºÙ„ Ø§Ù„Ù€ fetch)
    const defaultRates = {
      USD: { mid: 111.0 },
      AED: { mid: 30.24 },
      SAR: { mid: 29.61 },
      EUR: { mid: 129.73 },
      KWD: { mid: 361.37 },
      SEK: { mid: 12.0 },
      GBP: { mid: 149.07 },
      JOD: { mid: 156.63 }
    };

    const RATES_URL =
      "https://raw.githubusercontent.com/laithi/lira-telegram-bot/main/rates.json";

    function normalizeDigits(str) {
      return String(str)
        .replace(/[Ù -Ù©]/g, d => "0123456789"["Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(d)] ?? d)
        .replace(/,/g, "")
        .trim();
    }

    function App() {
      const [mode, setMode] = useState("oldToNew"); // oldToNew | newToOld
      const [input, setInput] = useState("");
      const [rates, setRates] = useState(defaultRates);

      // Ø¬Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù…Ù† rates.json (Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ ØªØ¨Ø¹ Ø§Ù„Ø¨ÙˆØª)
      useEffect(() => {
        fetch(RATES_URL)
          .then(res => res.json())
          .then(json => {
            if (json && json.rates) {
              setRates(json.rates);
            }
          })
          .catch(() => {
            console.log("Using default rates fallback");
          });
      }, []);

      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù†Ù…Ø¨Ø±
      const amount = (() => {
        const cleaned = normalizeDigits(input).replace(/[^0-9.]/g, "");
        const n = parseFloat(cleaned);
        return Number.isFinite(n) ? n : 0;
      })();

      // Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨ÙˆØª ØªÙ…Ø§Ù…Ø§Ù‹:
      // Ø¥Ø°Ø§ Oldâ†’New: Ø§Ù„Ù…Ø¯Ø®Ù„ = Ù‚Ø¯ÙŠÙ…ØŒ Ø§Ù„Ù†Ø§ØªØ¬ = Ø¬Ø¯ÙŠØ¯
      // Ø¥Ø°Ø§ Newâ†’Old: Ø§Ù„Ù…Ø¯Ø®Ù„ = Ø¬Ø¯ÙŠØ¯ØŒ Ø§Ù„Ù†Ø§ØªØ¬ = Ù‚Ø¯ÙŠÙ…
      const { oldAmount, newAmount } = useMemo(() => {
        if (mode === "oldToNew") {
          const oldVal = amount;
          const newVal = amount / RATE;
          return { oldAmount: oldVal, newAmount: newVal };
        } else {
          const newVal = amount;
          const oldVal = amount * RATE;
          return { oldAmount: oldVal, newAmount: newVal };
        }
      }, [amount, mode]);

      // ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹ (Ù…Ø«Ù„ Ø§Ù„Ø¨ÙˆØª)
      const breakdown = useMemo(() => {
        let current = newAmount;
        const list = [];
        if (current > 0) {
          DENOMS_NEW.forEach(d => {
            const count = Math.floor(current / d.v);
            if (count > 0) {
              list.push({ ...d, count });
              current = Math.round((current - count * d.v) * 100) / 100;
            }
          });
        }
        return { list, rem: current };
      }, [newAmount]);

      // ØªØ­ÙˆÙŠÙ„ ÙÙˆØ±ÙŠ Ù„Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (Base = New Lira)
      const fxValues = useMemo(() => {
        const nf = new Intl.NumberFormat("en-US", {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2
        });

        const results = {};
        CURRENCIES.forEach(c => {
          const r = rates?.[c.code]?.mid;
          if (!r || !Number.isFinite(Number(r)) || Number(r) <= 0 || newAmount <= 0) {
            results[c.code] = "0.00";
          } else {
            const val = newAmount / Number(r);
            results[c.code] = nf.format(val);
          }
        });
        return results;
      }, [newAmount, rates]);

      const nfAR = new Intl.NumberFormat("ar-SY", { maximumFractionDigits: 2 });

      return (
        <div className="min-h-screen py-6 px-3 sm:px-4 flex justify-center">
          <div className="w-full max-w-3xl space-y-5">

            {/* Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ */}
            <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
              <div>
                <h1 className="text-2xl sm:text-3xl font-black text-emerald-700 leading-tight">
                  Ù…Ø­ÙˆÙ‘Ù„ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ©
                </h1>
                <p className="text-xs font-semibold text-slate-500">
                  Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© â€“ ØªØ­ÙˆÙŠÙ„ Ù„Ø­Ø¸ÙŠ Ù…Ø¹ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ©
                </p>
              </div>
              <div className="flex bg-white rounded-2xl p-1 card-shadow border border-emerald-50">
                <button
                  onClick={() => setMode("oldToNew")}
                  className={
                    "px-3 sm:px-4 py-1.5 rounded-xl text-[11px] font-bold transition-all " +
                    (mode === "oldToNew"
                      ? "bg-emerald-600 text-white shadow"
                      : "text-slate-500")
                  }
                >
                  Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© (Ù„.Ø³)
                </button>
                <button
                  onClick={() => setMode("newToOld")}
                  className={
                    "px-3 sm:px-4 py-1.5 rounded-xl text-[11px] font-bold transition-all " +
                    (mode === "newToOld"
                      ? "bg-emerald-600 text-white shadow"
                      : "text-slate-500")
                  }
                >
                  Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                </button>
              </div>
            </div>

            {/* ÙƒØ±Øª Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ + Ø§Ù„Ù†Ø§ØªØ¬ */}
            <div className="bg-white rounded-[32px] p-6 sm:p-7 card-shadow border border-emerald-50">
              <div className="text-[11px] font-bold text-slate-400 mb-2">
                Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© ({mode === "oldToNew" ? "Ù„.Ø³ Ù‚Ø¯ÙŠÙ…Ø©" : "Ù„ÙŠØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©"})
              </div>
              <input
                type="text"
                inputMode="decimal"
                value={input}
                onChange={(e) => setInput(e.target.value)}
                placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ©"
                className="w-full text-4xl sm:text-5xl font-black bg-transparent outline-none text-slate-900 mb-6"
              />

              {/* Ø¨Ø·Ø§Ù‚Ø© Ù‚ÙŠÙ… Ø§Ù„Ù‚Ø¯ÙŠÙ… / Ø§Ù„Ø¬Ø¯ÙŠØ¯ */}
              <div className="grid sm:grid-cols-2 gap-4">
                <div className="rounded-2xl border border-emerald-50 bg-emerald-50/70 px-4 py-3 flex flex-col justify-between">
                  <div className="flex items-center justify-between mb-1">
                    <span className="text-xs font-semibold text-emerald-700">
                      Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                    </span>
                    <span className="text-[10px] font-bold text-emerald-500">NEW</span>
                  </div>
                  <div className="text-2xl sm:text-3xl font-black text-emerald-700">
                    {nfAR.format(newAmount)} Ù„.Ø³
                  </div>
                </div>

                <div className="rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3 flex flex-col justify-between">
                  <div className="flex items-center justify-between mb-1">
                    <span className="text-xs font-semibold text-slate-700">
                      Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
                    </span>
                    <span className="text-[10px] font-bold text-slate-400">OLD</span>
                  </div>
                  <div className="text-2xl sm:text-3xl font-black text-slate-800">
                    {nfAR.format(oldAmount)} Ù„.Ø³
                  </div>
                </div>
              </div>
            </div>

            {/* Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ© â€“ ØªØ­ÙˆÙŠÙ„ ÙÙˆØ±ÙŠ */}
            <div className="bg-white rounded-3xl p-5 card-shadow border border-emerald-50 space-y-4">
              <div className="flex items-center justify-between">
                <div>
                  <h2 className="text-sm font-black text-slate-700">
                    ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø£Ø¬Ù†Ø¨ÙŠØ©
                  </h2>
                  <p className="text-[10px] text-slate-400 font-semibold">
                    ÙŠØ­Ø³Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ù‚ÙŠÙ…Ø© Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù†Ø§ØªØ¬Ø© Ø¹Ù† Ø§Ù„ØªØ­ÙˆÙŠÙ„
                  </p>
                </div>
              </div>

              <div className="currency-grid">
                {CURRENCIES.map((c) => (
                  <div
                    key={c.code}
                    className="bg-slate-50 border border-slate-100 rounded-2xl px-3 py-3 flex flex-col justify-between card-shadow"
                  >
                    <div className="flex items-center justify-between mb-2">
                      <div className="flex items-center gap-2">
                        <span className="text-xl">{c.flag}</span>
                        <span className="text-sm font-bold text-slate-700">
                          {c.code}
                        </span>
                      </div>
                      <span className="text-[10px] font-semibold text-slate-400">
                        1 {c.code} = {rates?.[c.code]?.mid
                          ? new Intl.NumberFormat("en-US", {
                              minimumFractionDigits: 2,
                              maximumFractionDigits: 2
                            }).format(Number(rates[c.code].mid))
                          : "â€“"}{" "}
                        Ù„.Ø³ Ø¬Ø¯ÙŠØ¯Ø©
                      </span>
                    </div>

                    <div>
                      <div className="text-xl font-black text-emerald-700">
                        {fxValues[c.code]}
                      </div>
                      <div className="text-[10px] font-semibold text-slate-400 mt-0.5">
                        {c.name}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */}
            {breakdown.list.length > 0 && (
              <div className="bg-white rounded-3xl p-5 card-shadow border border-slate-100 space-y-3 mb-8">
                <h2 className="text-sm font-black text-slate-700">
                  ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© (Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯)
                </h2>
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                  {breakdown.list.map((p) => (
                    <div
                      key={p.v}
                      className="bg-slate-50 border border-slate-100 rounded-2xl px-3 py-3 flex items-center justify-between"
                    >
                      <div className="flex items-center gap-3">
                        <div className="w-10 h-10 rounded-xl bg-white flex items-center justify-center text-2xl">
                          {p.s}
                        </div>
                        <div>
                          <div className="text-lg font-black text-slate-800">
                            {p.v.toLocaleString("ar-SY")} Ù„.Ø³
                          </div>
                          <div className="text-[11px] text-slate-500 font-semibold">
                            {p.n}
                          </div>
                        </div>
                      </div>
                      <div className="bg-emerald-600 text-white rounded-xl px-3 py-1 text-sm font-black">
                        Ã—{p.count}
                      </div>
                    </div>
                  ))}
                </div>

                {breakdown.rem > 0 && (
                  <div className="mt-2 text-[12px] font-semibold text-amber-700 bg-amber-50 border border-amber-100 rounded-2xl px-3 py-2">
                    Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ù‚ÙŠ {nfAR.format(breakdown.rem)} Ù„ÙŠØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© ØºÙŠØ±
                    Ù…ØºØ·Ø§Ø© Ø¨Ø§Ù„ÙØ¦Ø§Øª.
                  </div>
                )}
              </div>
            )}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
